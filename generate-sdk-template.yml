# File: generate-sdk-template.yml
parameters:
- name: language
  type: string
- name: generateSDK
  type: boolean
  default: false

jobs:
- job: Generate_${{ parameters.language }}
  condition: eq('${{ parameters.generateSDK }}', 'true')
  steps:
  - script: |
      # Install Speakeasy CLI
      curl -fsSL https://speakeasyapi.dev/install.sh | sh
      speakeasy -v
    displayName: 'Install Speakeasy CLI'
    
  - script: |
      speakeasy generate sdk --lang ${{ parameters.language }} --input openapi.json --output ./sdks/${{ parameters.language }}
    displayName: 'Generate ${{ parameters.language }} SDK'

  - publish: ./sdks/${{ parameters.language }}
    artifact: ${{ parameters.language }}-sdk
    displayName: 'Publish ${{ parameters.language }} SDK as artifact'
